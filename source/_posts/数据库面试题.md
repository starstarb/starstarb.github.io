---
title: 数据库面试题
tags: 数据库
categories: 面试
abbrlink: d4eb4c98
date: 2019-07-20 14:32:52
---
leetcode数据库面试题
<!--more-->
### 1
表1: Person

+-------------+---------+
| 列名         | 类型     |
+-------------+---------+
| PersonId    | int     |
| FirstName   | varchar |
| LastName    | varchar |
+-------------+---------+
PersonId 是上表主键
表2: Address

+-------------+---------+
| 列名         | 类型    |
+-------------+---------+
| AddressId   | int     |
| PersonId    | int     |
| City        | varchar |
| State       | varchar |
+-------------+---------+
AddressId 是上表主键
 

编写一个 SQL 查询，满足条件：无论 person 是否有地址信息，都需要基于上述两表提供 person 的以下信息：

FirstName, LastName, City, State

链接：https://leetcode-cn.com/problems/combine-two-tables
代码：
```
# Write your MySQL query statement below
select FirstName,LastName,City,State from Person left join  Address on Person.PersonId=Address.PersonId;
```

### 2
编写一个 SQL 查询，获取 Employee 表中第二高的薪水（Salary） 。

+----+--------+
| Id | Salary |
+----+--------+
| 1  | 100    |
| 2  | 200    |
| 3  | 300    |
+----+--------+
例如上述 Employee 表，SQL查询应该返回 200 作为第二高的薪水。如果不存在第二高的薪水，那么查询应返回 null。

+---------------------+
| SecondHighestSalary |
+---------------------+
| 200                 |
+---------------------+
链接：https://leetcode-cn.com/problems/second-highest-salary



代码：
```
# Write your MySQL query statement below
select (select distinct Salary from Employee order by Salary desc limit 1 offset 1)as SecondHighestSalary



# Write your MySQL query statement below
select IFNULL((select distinct Salary from Employee order by Salary desc limit 1 offset 1  ),null) as SecondHighestSalary
```
### 3
给定一个 salary 表，如下所示，有 m = 男性 和 f = 女性 的值。交换所有的 f 和 m 值（例如，将所有 f 值更改为 m，反之亦然）。要求只使用一个更新（Update）语句，并且没有中间的临时表。

注意，您必只能写一个 Update 语句，请不要编写任何 Select 语句。

例如：

| id | name | sex | salary |
|----|------|-----|--------|
| 1  | A    | m   | 2500   |
| 2  | B    | f   | 1500   |
| 3  | C    | m   | 5500   |
| 4  | D    | f   | 500    |
运行你所编写的更新语句之后，将会得到以下表:

| id | name | sex | salary |
|----|------|-----|--------|
| 1  | A    | f   | 2500   |
| 2  | B    | m   | 1500   |
| 3  | C    | f   | 5500   |
| 4  | D    | m   | 500    |

链接：https://leetcode-cn.com/problems/swap-salary
算法：
 要想动态地将值设置成列，我们可以在使用case wehn语句时，使用update

Mysql
```
UPDATE salary
SET
    sex=CASE sex
         WHEN 'm' THEN 'f'
         ELSE 'm'
    END; 


```